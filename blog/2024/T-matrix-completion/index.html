<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>What is going on with the T in low-rank matrix completion? | Chandler Smith's Webpage</title> <meta name="author" content="Chandler M. Smith"> <meta name="description" content="The tangent space type object in matrix completion appears across the literature. This brief exposition will hopefully explain it!"> <meta name="keywords" content="mathematics, optimization, machine learning, probability, optimal transport"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://chandlersmith2.github.io/blog/2024/T-matrix-completion/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Chandler Smith's Webpage</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">What is going on with the T in low-rank matrix completion?</h1> <p class="post-meta">September 12, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/matrix-completion"> <i class="fa-solid fa-hashtag fa-sm"></i> matrix-completion,</a>   <a href="/blog/tag/riemannian-geometry"> <i class="fa-solid fa-hashtag fa-sm"></i> riemannian-geometry</a>     ·   <a href="/blog/category/posts"> <i class="fa-solid fa-tag fa-sm"></i> posts</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>If you’ve done any reading across matrix completion literature, you’ve undoubtedly run into this object that mathematicians in the field like to denote as \(T\). I’ll briefly set up the problem first, introducing some standard notations before diving into what’s hopefully an interesting exposition. If you’re familiar with matrix completion, you can skip through the first section. Throughout this, I’ll be working with square matrices, although these ideas generalize to non-square matrices quite readily.</p> <p><strong><em>Intuitive introduction to matrix completion</em></strong></p> <p>Imagine that you want to access an arbitrary matrix \(X\in\mathbb{R}^{n\times n}\), but only have access to some of the entries in said matrix. This problem is quite ill-posed in general, but with the edifying assumption that \(X\) is low-rank, you <em>might</em> have a chance of accomplishing this task. By low-rank, I mean that if \(\textrm{rank}(X)=r\), \(r\ll n\), far less than the ambient dimension of the matrix one wishes to recover. Intuitively, this is possible because of the sheer amount of repeated information in a high-dimensional low-rank matrix. Once you’ve accessed a comparably small fraction of the overall entries, you’ve probably seen enough information to recover said matrix. What constitutes a reasonably sized fraction and what low-rank matrices are recoverable is a different question, and not the focus of this blog post. Under an elementwise Bernoulli sampling model, just take \(p\geq C\frac{\log(n)}{n}\) and you’re likely to have enough for some matrix-specific constant \(C\). How this \(C\) scales is very interesting as well, but again, not the focus of this.</p> <p>Let \(\Omega\subset \{1,...,n\}\times\{1,...,n\}\) denote the subset of revealed entries in your ground truth matrix, and let \(\mathcal{R}_\Omega :\mathbb{R}^{n\times n} \to \mathbb{R}^{\vert\Omega\vert}\) be the map that extracts entries of a matrix: that is,</p> \[\mathcal{R}_\Omega(X) = (X_{ij})_{(i,j)\in\Omega}\] <p>(Note: If you’re coming to this blogpost from a paper I’ve written on low-rank completion for EDG, this \(\mathcal{R}_\Omega\) is not the same! This one is following notation from <a href="https://arxiv.org/abs/0805.4471" rel="external nofollow noopener" target="_blank"> [1]</a>).</p> <p>A first pass objective function for recovering a ground-truth matrix $X$ from your observed information might be something along the lines of minimizing the following:</p> \[\textrm{min}_{Y\in\mathbb{R}^{n\times n}} ~ \textrm{rank}(Y) ~\textrm{ subject to } \mathcal{R}_\Omega(Y) = \mathcal{R}_\Omega(X)\] <p>This problem is NP-hard, however, and therefore not computationally feasible. Seemingly inspired from compressive sensing literature , <a href="https://arxiv.org/abs/0805.4471" rel="external nofollow noopener" target="_blank"> [1]</a> proposed the following objective to recover a low-rank matrix instead:</p> \[\textrm{min}_{Y\in\mathbb{R}^{n\times n}} ~ \Vert Y\Vert_\star ~\textrm{ subject to } \mathcal{R}_\Omega(Y) = \mathcal{R}_\Omega(X)\] <p>where \(\Vert Y \Vert_\star = \sum_{i=1}^r \sigma_i\) is the sum of the singular values of a matrix. This is now a convex optimization procedure, and we can use the tools of convex analysis to characterize solutions to the above optimization routine.</p> <p><strong><em>Duality</em></strong></p> <p>In <a href="https://arxiv.org/abs/0805.4471" rel="external nofollow noopener" target="_blank"> [1]</a>, the authors note the following in Section 3 of their text. From above, we have a characterization of our constraint set, and we can state the following result from convex optimization theory: $Y$ is a solution to the minimization routine above if there exists a Lagrange multiplier \(\lambda\in\mathbb{R}^{\vert\Omega\vert}\) such that</p> \[\mathcal{R}^\star_\Omega \lambda \in \partial\Vert X\Vert_\star\] <p>where \(\partial\Vert X\Vert_\star\) is the subdifferential of \(\Vert X\Vert_\star\) and \(\mathcal{R}^\star_\Omega\) is the adjoint to \(\mathcal{R}_\Omega\). Elements of the subdifferential, which is a set, are called subgradients, so the above equation says that \(\mathcal{R}^\star_\Omega \lambda\) is a subgradient at \(X\). Recall that for a function \(f:\mathbb{R}^{n\times n}\to \mathbb{R}\), a subgradient \(Y\) at a point \(X_0\) is characterized by the following inequality, which must hold for all \(X\):</p> \[f(X)\geq f(X_0) + \langle Y,X-X_0\rangle\] <p>where \(\langle A,B\rangle = \textrm{Tr}(A^T B) = \sum_{(i,j)\in\Omega}A_{ij}B_{ij}\) is the standard trace inner product. Thus, the subdifferential is just the collection of objects that satisfies the above inequality. Note that if the function \(f\) is smooth, the subdifferential would have one element in it, which would be the Euclidean gradient!</p> <p>The subdifferential of the nuclear norm is as follows:</p> \[\partial \Vert A\Vert_\star = \left\{ B\in\mathbb{R}^{n\times n} \quad \big\vert \quad \Vert C\Vert_\star \geq \Vert A\Vert_\star + \langle B,C-A\rangle ~\forall C\in \mathbb{R}^{n\times n} \right\}\] <p><strong><em>Watson’s Subdifferential Characterization</em></strong></p> <p>To characterize the subdifferential above, we look to <a href="https://www.sciencedirect.com/science/article/pii/0024379592904072" rel="external nofollow noopener" target="_blank">[2]</a>. This paper characterizes the subdifferential of orthogonally invariant norms and operator norms, with some specific results derived additionally. For simplification, <a href="https://www.sciencedirect.com/science/article/pii/0024379592904072" rel="external nofollow noopener" target="_blank">[2]</a> looks at unitarily invariant norms to start. Unitarily invariant norms need to satisfy a gauge function relationship, i.e. we have that \(\Vert A\Vert = \phi(\mathbf{\sigma})\), where \(\mathbf{\sigma} = [\sigma_1,...,\sigma_n]^T\) is a vector of singular values of \(A\), for a positive definite gauge function \(\phi\). Schatten p-norms are an example, as matrix norms that can be characterized by \(\Vert A\Vert = \Vert \mathbf{\sigma}\Vert_p\), where , and \(\Vert\cdot\Vert_p\) is an \(l_p\) norm on \(\mathbb{R}^n\). The nuclear norm is just the Schatten-1 norm, the spectral norm is the Schatten-\(\infty\) norm, and the Frobenius norm is the Schatten-2 norm. As such, this is a pretty versatile class to investigate!</p> <p>Before diving into the meat of <a href="https://www.sciencedirect.com/science/article/pii/0024379592904072" rel="external nofollow noopener" target="_blank">[2]</a>, we’ll provide a couple of preliminary properties that will be used in the proof of the subdifferential. First, note a couple of properties of the subdifferential of matrix norms: \(G\in\partial \Vert A\Vert\) is equivalent to</p> \[1. \Vert A\Vert = \textrm{Tr}(G^TA) \qquad 2.\Vert G\Vert^\star \leq 1\] <p>where \(\Vert\cdot\Vert^\star\) is the dual norm to \(\Vert\cdot\Vert\).</p> <p>Next, we define the polar \(\phi^\star\) of the gauge function \(\phi\) to be \(\phi^\star(x) = \max_{\phi(y)=1} x^T y\). We have now that \(z\in\partial\phi(x)\) is equivalent to</p> \[1. \phi(x)=x^Tz \qquad 2. \phi^\star(z)\leq 1\] <p>by analogy to the matrix subdifferential property. The connection between the gauge function and the matrix norm is leveraged quite a lot, and leads to some strong results.</p> <p>We can now begin the characterization of the subdifferential of an unitarily invariant norm.</p> <p><strong>Lemma:</strong> For \(A,R\in\mathbb{R}^{n\times n}\), and \(A = U\Sigma V^T\), we have that</p> \[\lim_{\gamma\to 0^+} \displaystyle\frac{\Vert A+\gamma R\Vert- \Vert A\Vert}{\gamma} = \max_{d\in\partial\phi(\sigma)}\sum_{i=1}^n d_i \mathbf{u}_i^TR \mathbf{v}_i\] <p><strong>Proof:</strong> I’ll provide a brief sketch of the proof below. Let \(\sigma_i\) be a distinct singular value of \(A\), or \(Av_i = \sigma_i u_i\). If we further assume that \(A\) smoothly depends on some parameter \(\gamma\), then we can see then that</p> \[\frac{\partial \sigma_i}{\partial \gamma} = u_i^T\frac{\partial A}{\partial \gamma} v_i\] <p>As such, we can use a Taylor expansion to see that, if our perturbation is of the form \(A+\gamma R\) for an arbitrary matrix \(R\), that \(\sigma_i(\gamma) = \sigma_i + \gamma u_i^T R v_i + o(\gamma)\). Now, as \(\Vert A\Vert = \phi(\sigma)\) for some gauge function \(\phi\), we can see that for any \(d(\gamma)\in\partial \phi(\sigma(\gamma))\) that</p> \[\Vert A\Vert \geq \sigma^Td(\gamma) = \sigma(\gamma)^Td(\gamma) - \gamma \sum_{i=1}^n d_i(\gamma)u_i^TRv_i + o(\gamma) = \Vert A+\gamma R\Vert - \gamma \sum_{i=1}^n d_i(\gamma)u_i^TRv_i + o(\gamma)\] <p>Additionally, \(\Vert A+\gamma R\Vert = \phi(\sigma(\gamma))\geq \sigma(\gamma)^Td\) for \(d\in\partial\phi(\sigma)\). Rearranging these bounds and taking the limit gets us the result that we want. There’s some trickiness with repeated singular values sometimes, but there are ways around this.</p> <p>Now that the directional derivative has been characterized, we can use this to characterize the subdifferential as a convex hull of things in the subdifferential of the $l_p$ norm generating the Schatten-$p$ norm.</p> <p><strong>Theorem:</strong> For diagonal \(\textrm{diag}(\mathbf{d})=D\in\mathbb{R}^{n\times n}\), we have that</p> \[\partial \Vert A\vert = \textrm{conv}\left\{ UDV^T,~A=U\Sigma V^T,~\mathbf{d}\in\partial\phi(\mathbf{\sigma}) \right\}\] <p><strong>Proof:</strong> First denoting \(S =\left\{ UDV^T,~A=U\Sigma V^T,~\mathbf{d}\in\partial\phi(\mathbf{\sigma}) \right\}\), we want to take an element \(G\in\textrm{conv}(S(A))\). We have that, for \(\sum_i \lambda_i = 1, \lambda_i\geq0\),</p> \[\textrm{Tr}(G^T A) = \textrm{Tr}\left( A^T \sum_i \lambda_i U_i D_i V_i^T\right) = \sum_i \lambda_iV_i\Sigma U_i^TU_iD_i V_i^T = \sum_i \lambda_i d_i^T \sigma = \Vert A\Vert\] <p>for \(d_i \in\partial\phi(\sigma)\). This just follows from the properties that were outlined at the beginning of this section. Furthermore, we want that \(\Vert G\Vert^\star\leq 1\). To see that this holds, we can take</p> \[\Vert G\Vert^\star =\max_{\Vert R\Vert\leq 1} \textrm{Tr}(G^T R)=\max_{\Vert R\Vert\leq 1} \textrm{Tr}\left(R^T\sum_i U_i D_i V_i^T\right)\] <p>Additionally as</p> \[\Vert U_i D_i V_i^T\Vert^\star = \Vert D_i\Vert^\star = \phi^\star(d_i)=1\] <p>then we can see that as \(\Vert A\Vert^\star = \phi^\star(\sigma)\), we can combine these results to see that \(\textrm{Tr}(R^T U_iD_iV_i^T)\leq \Vert R\Vert\), giving us that \(\Vert G\Vert^\star\leq 1\) so \(G\in\partial\Vert A\Vert\).</p> <p>To see the other way, that is \(G\in\partial \Vert A\Vert\) but \(G\not\in\textrm{conv}(S(A))\), we can use a standard convex separation result indicating that</p> \[\textrm{Tr}(R^T H)&lt; \textrm{Tr}(R^T G)\] <p>for any \(H\in S(A)\). Now, we see that</p> \[\max_{H\in S(A)} \textrm{Tr}(R^T H)&lt; \max _{G\in\partial \Vert A\Vert}\textrm{Tr}(R^T G)\] <p>which holds for any SVD</p> \[\max_{d\in\partial\phi(\sigma)} \sum_i^nd_iu_i^TRV_i&lt; \max _{G\in\partial \Vert A\Vert}\textrm{Tr}(R^T G)\] <p>but as the RHS is a directional derivative of a convex function \(\Vert A\Vert\) in the direction \(R\), the directional derivative theorem is violated, giving us the contradiction we desired.</p> <p>Now we can characterize that this for the nuclear norm! This is then something we can characterize as, for a rank \(k\) object with a thin SVD of \(A=U\Sigma V^T\), \(U,V\in\mathbb{R}^{n\times k}\),</p> \[\partial \Vert A\Vert_\star = \left\{UV^{T} + U_\perp TV_\perp^{T} \big\vert \sigma_1(T)\leq 1\right\}\] <p>where \(U_\perp\) and \(V_\perp\) consist of orthonormal vectors perpendicular to those in \(U\) and \(V\), respectively. We could build out a full SVD of \(A\) as \(A=U'\Sigma'V'^T\)</p> \[U' = \left[\underbrace{\mathbf{u_1}...\mathbf{u}_k}_{U} \right\vert\left.\underbrace{\mathbf{u_{k+1}}...\mathbf{u}_n}_{U_\perp} \right]\] <p>and the same with \(V\), where now \(U'\) and \(V'\) are proper orthogonal/unitary matrices. This fully characterizes the subdifferential of nuclear norm.</p> <p>To make things easier, we create the orthogonal decomposition of \(\mathbb{R}^{n\times n} = T\oplus T^\perp\), where \(T\) the set spanned by \(u_k x + yv_k^T\). This has a nice projection formula too, and allows us to characterize when we’re in the subdifferential of the ground truth as a projection onto \(T\). This is given by</p> \[P_T X = P_U X+ X P_V - P_U XP_V\] <p>where \(P_U = UU^{T}\), and similarly for \(P_V\). As such, we have \(Y\in\partial \Vert X\Vert\) if \(\mathcal{P}_T Y = \sum_{k=1}^r u_k v_k^T\) and \(\Vert P_{T^\perp} Y \Vert_2\leq 1\). Proving existence of unique minimizers is basically verifying this property.</p> <p><strong><em>Characterization of the tangent space of the rank-r manifold</em></strong></p> <p>At the end of <a href="https://arxiv.org/abs/0805.4471" rel="external nofollow noopener" target="_blank"> [1]</a>, they note that \(\textrm{dim}(T) = r(2n-r)\), which is the same as the dimension of the set of rank-\(r\) matrices. Well, this set happens to be a smooth manifold! Let’s go through a proof to see if we can dig up a connection between the subdifferential of the nuclear norm and this manifold.</p> <p>First, let’s prove that the set of rank-$r$ matrices is actually a smooth manifold. This section is adapted from the wonderful text <a href="https://www.nicolasboumal.net/book/" rel="external nofollow noopener" target="_blank">[3]</a>.</p> <p>Let</p> \[\mathbb{R}^{n\times n}_{r} = \left\{X\in\mathbb{R}^{n\times n} ~\vert ~\textrm{rank}(X)=r\right\}\] <p>We can prove that this is a smooth manifold as follows. We can assume that</p> \[X = \begin{bmatrix} X_{11} &amp; X_{12} \\ X_{21} &amp; X_{22}\end{bmatrix}\] <p>where \(X_{11}\) is invertible, \(X_{12} \in\mathbb{R}^{r\times(n-r)}\),\(X_{21} \in\mathbb{R}^{(n-r)\times r}\), \(X_{22} = \mathbb{R}^{(n-r)\times (n-r)}\). Under the assumptions, as the last \(n-r\) columns must be linear combinations of the first \(r\) (as its rank \(r\)), there should exist a \(W\in\mathbb{R}^{r\times (n-r)}\) such that</p> \[\begin{bmatrix}X_{12}\\ X_{22}\end{bmatrix} = \begin{bmatrix}X_{11}\\ X_{21} \end{bmatrix}W\] <p>This means that we can solve this by \(W = X_{11}^{-1}X_{12}\), indicating that \(X_{22} = X_{21}W = X_{21}X_{11}^{-1}X_{12}\). If we let \(\mathcal{U}\) be the open subset of \(\mathbb{R}^{n\times n}\) consisting of invertible size \(r\times r\) upper left submatrices, this suggests the local defining function \(h:\mathcal{U}\to\mathbb{R}^{(n-r)\times (n-r)}\) as</p> \[h(X) = X_{22} - X_{21}X_{11}^{-1}X_{12}\] <p>As this is smooth, this is a candidate for the local defining function for a smooth manifold. Following this, we can see that the inverse image \(h^{-1}(0) = \mathbb{R}^{n\times n}_{r} \cap \mathcal{U}\). Omitting gory details, we can see that</p> \[\textrm{D}h(Y)[V] = V_{22} - V_{21}Y_{11}^{-1}Y_{12} + Y_{21}Y_{11}^{-1}V_{11}Y_{11}^{-1}Y_{12} - Y_{21}Y_{11}^{-1}V_{12}\] <p>and as the image of \(\textrm{D}h(Y)\) is \(\mathbb{R}^{(n-r)\times(n-r)}\), we can see that the differential is surjective (set \(V_{11},~V_{21},~V_{12}\) to zero so that the map is just \(V_{22}\)). As this is a surjective map, we have a local defining function! If the upper left submatrix isn’t an \(r\times r\) invertible matrix, we can change the local defining function at different parts of \(\mathbb{R}^{n\times n}_{r}\) for each choice of submatrix and viola! We’ve constructed an embedded submanifold of \(\mathbb{R}^{n\times n}\). To see the claim by <a href="https://arxiv.org/abs/0805.4471" rel="external nofollow noopener" target="_blank"> [1]</a> on the dimension, notice that</p> \[\textrm{dim}(\mathbb{R}^{n\times n}_{r}) = \textrm{dim}(\mathbb{R}^{n\times n}) - \textrm{dim}(\mathbb{R}^{(n-r)\times (n-r)}) = n^2-(n-r)^2 = r(2n-r)\] <p>Now, the goal of this was to construct the tangent space of \(\mathbb{R}^{n\times n}_{r}\), which we will do as follows. One could compute the tangent space by studying the kernel of \(\textrm{D}h\) for the various \(h\) functions that define the manifold, but this is difficult to work with for a number of reasons. As we like thin SVDs of matrices for storage, amongst other things, we will use this as a way to characterize our tangent space. Since we know the dimension of the tangent space from above, we just need to find a linear subspace of the proper dimension contained in \(T_X\mathbb{R}^{n\times n}_{r}\) for any point \(X\in\mathbb{R}^{n\times n}_{r}\), as we will have then found \(\mathbb{R}^{n\times n}_{r}\). We can do this by constructing smooth curves, which should hopefully be more illuminating!</p> <p>For a thin SVD of a point \(X = U\Sigma V^T\), where \(U,V\in\textrm{St}(n,r)\), we can try to construct curves on \(\mathbb{R}^{n\times n}_{r}\). Let’s let $U(t)$ be a smooth curve on \(\textrm{St}(n,r)\) with \(U(0)=U\), and similarly for \(V\), and let \(\Sigma(t)\) be a smooth curve on invertible \(r\times r\) matrices (an open submanifold of \(\mathbb{R}^{r\times r})\), with \(\Sigma(0)=\Sigma\). As such, the curve \(c(t) = U(t)\Sigma(t)V(t)^T\) is a smooth curve on \(\mathbb{R}^{n\times n}_{r}\) with \(c(0)=X\). We can compute the velocity vector at \(t=0\) as follows:</p> \[c'(0) = U'(0)\Sigma V^T + U\Sigma'(0)V^T + U\Sigma V'(0)^T\in T_X\mathbb{R}^{n\times n}_{r}\] <p>As \(U,V\) are smooth curves in \(\textrm{St}(n,r)\), we can see that the velocity vectors \(U'(0),V'(0)\) are in the tangent space to \(\textrm{St}(n,r)\) at \(U\) and \(V\) respectively. As the tangent space</p> \[T_X\textrm{St}(n,r) = \left\{X\Omega+X_\perp B\right\vert \left. \Omega\in\textrm{Skew}(r),~B\in\mathbb{R}^{(n-r)\times r}\right\}\] <p>is well-established, we can find a curve such that for any \(r\times r\) skew-symmetric \(\Omega\) and \(B\in\mathbb{R}^{(n-r)\times r}\) we can take \(U'(0) = U\Omega +U_\perp B\), where \(U_\perp\) is such that \([U~ U_\perp]\) is an orthogonal matrix. We can do the same for \(V'(0) = V\Omega' + V_\perp C\). For \(\Sigma'(0)\), this can be any matrix \(A\in\mathbb{R}^{r\times r}\). Now, we can combine all of this to see that</p> \[c'(0) = (U\Omega + U_\perp B)\Sigma V^T + UAV^T _ U\Sigma(V\Omega'+V_\perp C)^T\] \[= U\underbrace{(\Omega\Sigma + A-\Sigma \Omega')}_MV^T + \underbrace{U_\perp B\Sigma}_{U_p} V^T + U\underbrace{(V_\perp C \Sigma)^T}_{V_p}\] <p>Since \(\Sigma\) is invertible, \(M\) is arbitrary, and the conditions on \(U_p\) and \(V_p\) amount to \(2r^2\) constraints. As such, our total dimension amounts to \(r^2 + 2nr - 2r^2 = r(2n-r)\). This means that we have found the whole tangent space using this curve.</p> <p>Now, how can we project onto this space? It’s not hard to see that the normal space, given \(X=U\Sigma V^T\), can be computed by</p> \[N_X \mathbb{R}^{n\times n}_r = \left\{U_\perp W V_\perp^T \left\vert W\in\mathbb{R}^{(n-r)\times (n-r)}\right.\right\}\] <p>so an orthogonal projection onto $T_X$ should satisfy</p> <p>\(Z-\textrm{Proj}_X (Z) = U_\perp W V_\perp^T\) and \(\textrm{Proj}_X (Z) = UMV^T + U_p V^T + UV_p^T\)</p> <p>as long as \(U^TU_p = 0,~V^TV_p = 0\). Together,</p> \[Z = UMV^T + U_pV^T + UV_p^T + U_\perp W V_\perp^T\] <p>If we set \(\mathcal{P}_U = UU^T\), and similarly for \(V\), we end up seeing that</p> \[\textrm{Proj}_X(Z) = \mathcal{P}_U Z \mathcal{P}_V + \mathcal{P}_U^\perp Z \mathcal{P}_V + \mathcal{P}_U Z \mathcal{P}_V^\perp\] \[= \mathcal{P}_U Z + Z\mathcal{P}_V - \mathcal{P}_U Z \mathcal{P}_V\] <p>the same exact formula as the projection onto the space spanned by \(u_k x + yv_k^T\), seen in the characterization of the subgradient of the nuclear norm. This indicates that these spaces are the same, which is what we expected at the beginning.</p> <p><strong><em>Speculative link between these ideas</em></strong></p> <p>So, what’s the connection between these ideas? The nuclear norm/trace heuristic idea has been unreasonably successful for the idea of low-rank matrix completion, and further geometric ideas have been pretty effective as well. Why do these ideas seem so intertwined? I’d first speculate that the selection of \(T\) in <a href="https://arxiv.org/abs/0805.4471" rel="external nofollow noopener" target="_blank">[1]</a> was in a large part a deliberate choice to attempt to match the structure with an existing object. There was a convenience to choosing an orthogonal decomposition of a space into something well-characterized, (i.e. the tangent space to \(\mathbb{R}^{n\times n}_r\)), but it also aesthetically matches neatly with the idea behind matrix completion. The notion of rank plays so strongly into this, as well as notions of incoherence (properties of the row/column spaces), that it made sense to choose this object as a reference point.</p> <p>Now, the fact that the subdifferential of the nuclear norm has <em>most</em> of its components along the $UV^T$ direction hints at some of the utility of choosing the nuclear norm as a good surrogate for rank. Although there are other unitarily invariant norms that leverage a symmetric gauge function to build out a matrix from singular values, this particular one possesses such a neat decomposition into \(UV^T + U_\perp B V_\perp^T\) for small \(B\) that it captures much of the underlying information of the ground truth.</p> <p>I think there’s a lot I still don’t understand about this relationship, since it feels a little deeper than a choice made from mere convenience, but I’ll leave this as is for now.</p> <p><strong><em>Bibliography</em></strong></p> <p><a href="https://arxiv.org/abs/0805.4471" rel="external nofollow noopener" target="_blank"> [1]: “Exact Matrix Completion via Convex Optimization” by Emmanuel Candès and Benjamin Recht</a></p> <p><a href="https://www.sciencedirect.com/science/article/pii/0024379592904072" rel="external nofollow noopener" target="_blank">[2]: “Characterization of the subdifferential of some matrix norms” by G.A. Watson</a></p> <p><a href="https://www.nicolasboumal.net/book/" rel="external nofollow noopener" target="_blank">[3]: “An Introduction to Optimization on Smooth Manifolds” by Nicolas Boumal</a></p> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Chandler M. Smith. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>